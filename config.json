{
    "config": {
        "showExit1": false,
        "cachedFields": {
            "commitMessage": {
                "desc": "Commit message",
                "default": "commit",
                "input": true
            }
        },
        "runAtStart":"Git details"   
    },
    "actions": [
        {
            "name": "Git details",
            "desc": "Check local files",
            "hide": true,
            "list": [
                {
                    "cmd": "git",
                    "args": [
                        "config",
                        "-l"
                    ],
                    "outFile": "memory:gituser|user.name,=,1"
                }
            ]
        },
        {
            "name": "Start Code",
            "desc": "Start the dev environment",
            "list": [
                {
                    "cmd": "code",
                    "args": [
                        "."
                    ]
                }
            ]
        },
        {
            "name": "Git status",
            "desc": "Check local git status",
            "list": [
                {
                    "cmd": "clear",
                    "args": []
                },
                {
                    "cmd": "git",
                    "args": [
                        "status"
                    ]
                }
            ]
        },
        {
            "name": "Git add",
            "desc": "Stage local files",
            "list": [
                {
                    "cmd": "git",
                    "args": [
                        "add",
                        "."
                    ]
                }
            ]
        },
        {
            "name": "Git commit",
            "desc": "Commit local files",
            "list": [
                {
                    "cmd": "git",
                    "args": [
                        "commit",
                        "-m",
                        "%{commitMessage}"
                    ]
                }
            ]
        },
        {
            "name": "Create 'gitpush'",
            "desc": "Script for %{gituser}",
            "list": [
                {
                    "cmd": "wget",
                    "outFile": "memory:gitauth",
                    "args": [
                        "-q",
                        "--output-document=-",
                        "http://192.168.1.243:8080/files/user/stuart/loc/mydb/name/%{gituser}"
                    ]
                },
                {
                    "cmd": "echo",
                    "outFile": "gitpush",
                    "args": [
                        "gitpush.sh %{gituser} %{gitauth} &"
                    ]
                },
                {
                    "cmd": "chmod",
                    "args": [
                        "+x",
                        "gitpush"
                    ]
                }
            ]
        },
        {
            "name": "Remove 'gitpush'",
            "desc": "Remove push script 'gitpush'",
            "list": [
                {
                    "cmd": "rm",
                    "args": [
                        "gitpush"
                    ]
                }
            ]
        },
        {
            "name": "Create Looper",
            "desc": "Run gtool exec gitpush.sh, loop",
            "hide": true,
            "list": [
                {
                    "cmd": "echo",
                    "outFile": "run.sh",
                    "args": [
                        "#!/bin/bash\n",
                        "FILE=gitpush.sh\n",
                        "while true; do\n",
                        "  if [ -f \"$FILE\" ]; then\n",
                        "    rm $FILE\n",
                        "  fi\n",
                        "  ./gtool\n",
                        "  if [ $? -eq 1 ]\n",
                        "  then\n",
                        "    exit\n",
                        "  fi\n",
                        "  if [ -f \"$FILE\" ]; then\n",
                        "    ./gitpush.sh\n",
                        "  fi\n",
                        "  sleep 5\n",
                        "done\n"
                    ]
                },
                {
                    "cmd": "chmod",
                    "args": [
                        "+x",
                        "run.sh"
                    ]
                }
            ]
        }
    ]
}